"use strict";(self.webpackChunkdocuments_react=self.webpackChunkdocuments_react||[]).push([[955],{4955:function(e,n,t){t.r(n),t.d(n,{default:function(){return S}});var a=t(2506),l=t(3967),i=t(1582),s=t(7886),r=t(9281),c=t(5527),d=t(9836),o=t(6890),u=t(5855),h=t(3994),m=t(3382),p=t(2791);var x=t(4045),f=t(9434),j=t(9706),g=t(3786),Z=t(4294),b=t(184);const y=(e,n)=>{const t=e[0];let a={position:"",rank:"",fullName:""};const l=e=>{a[e.target.name]=e.target.value};return(0,b.jsxs)(i.Z,{sx:{width:"100%"},children:[["position","rank","fullName"].map(((e,n)=>(0,b.jsxs)(i.Z,{direction:"row",sx:{display:"flex",justifyContent:"space-evenly",padding:"1rem"},children:[(0,b.jsx)(s.Z,{value:e,inputProps:{readOnly:!0},sx:{padding:"1rem"}}),(0,b.jsx)(s.Z,{id:"demo-simple-select",label:"select column",select:!0,onChange:l,sx:{padding:"1rem",width:"20rem"},name:e,children:Object.keys(t).map((e=>(0,b.jsx)(g.Z,{value:e,children:t[e]})))})]},`excelElement${n}`))),(0,b.jsx)(Z.Z,{variant:"contained",onClick:()=>{n(a,e)},children:"Submit"})]})},k=e=>{let{...n}=e;const{errors:t,touched:g,setFieldValue:Z}=(0,a.u6)(),{handleClear:k}=((0,l.Z)(),function(){const{setFieldValue:e}=(0,a.u6)();return{handleClear:(0,p.useCallback)((()=>{e("excel","")}),[e])}}()),v=(0,f.I0)(),C=(0,f.v9)((e=>e.peoples));(0,p.useEffect)((()=>{v({type:j.Uy})}),[]);const w=(e,n)=>{const t=n.map(((n,t)=>{if(t)return{position:n[e.position],rank:n[e.rank],fullName:n[e.fullName]}}));t.shift(),v({type:j.rQ,data:t}),v({type:j.et,data:t})},S=(0,p.useCallback)((e=>{if(e.preventDefault(),e.target.files){const n=new FileReader;n.onload=e=>{const n=e.target.result,t=(0,x.ij)(n,{type:"array"}),a=t.SheetNames[0],l=t.Sheets[a],i=x.P6.sheet_to_json(l);v({type:j.a6,opened:!0,data:{title:"select field",content:y(i,w)}})},n.readAsArrayBuffer(e.target.files[0])}}),[]);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(a.l0,{...n,children:(0,b.jsx)(i.Z,{direction:"row",children:(0,b.jsx)(a.gN,{name:"password",component:s.Z,required:!0,errors:g.excel&&t.excel,clear:k,label:"chose file",type:"file",focused:!0,onChange:S})})}),(0,b.jsx)(r.Z,{component:c.Z,sx:{margin:"1rem",width:"97%"},children:(0,b.jsxs)(d.Z,{sx:{minWidth:300},"aria-label":"simple table",children:[(0,b.jsx)(o.Z,{children:(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(h.Z,{align:"right",children:"name"}),(0,b.jsx)(h.Z,{align:"right",children:"rank"}),(0,b.jsx)(h.Z,{align:"right",children:"position"})]})}),(0,b.jsx)(m.Z,{children:C.data.map(((e,n)=>(0,b.jsxs)(u.Z,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,b.jsx)(h.Z,{component:"th",scope:"row",children:e.fullName}),(0,b.jsx)(h.Z,{align:"right",children:e.rank}),(0,b.jsx)(h.Z,{align:"right",children:e.position})]},`tableRow${n}`)))})]})})]})};var v=t(1724);const C={excel:""};function w(){const e=(0,p.useMemo)((()=>v.Ry().shape({excel:v.Z_().required("validations.required")})),[]);return{initialValues:C,useValidationSchema:e}}var S=()=>{const{handleSubmit:e}={handleSubmit:(0,p.useCallback)((async e=>{}),[])},{initialValues:n,useValidationSchema:t}=w();return(0,b.jsx)(a.J9,{initialValues:n,onSubmit:e,validationSchema:t,validateOnChange:!1,children:(0,b.jsx)(k,{})})}}}]);
//# sourceMappingURL=955.2ad2c27e.chunk.js.map